@if (combinedExerciseData$ | async; as exerciseData) {
<div class="flex flex-col gap-4 p-4">
    <div class="text-4xl font-semibold text-center">
        {{ exerciseData.baseData.name }}
    </div>
    <div
        class="overflow-hidden border-2 border-solid rounded-md border-neutral-900"
    >
        <video
            controls
            [src]="exerciseData.detailsData.instructionVideoPreviewUrl"
        ></video>
    </div>
    <div class="flex flex-col gap-4">
        <div class="flex flex-col items-center gap-2">
            <div class="font-semibold">
                Main muscle group{{
                    exerciseData.baseData.mainMuscleGroups.length === 1
                        ? ""
                        : "s"
                }}:
            </div>

            <div class="flex items-center gap-2">
                @for (mainMuscleGroup of exerciseData.baseData.mainMuscleGroups;
                track $index) {
                <a
                    class="flex flex-col items-center gap-0.5"
                    [routerLink]="mainMuscleGroup.id"
                >
                    <div
                        class="overflow-hidden border-2 border-solid rounded-full min-w-max border-emerald-500"
                    >
                        <img
                            [src]="mainMuscleGroup.imagePreviewUrl"
                            class="w-12 h-12 bg-neutral-950"
                            [alt]="mainMuscleGroup.name + ' graphic'"
                        />
                    </div>

                    <div class="text-sm font-semibold text-emerald-500">
                        {{ mainMuscleGroup.name }}
                    </div>
                </a>
                }
            </div>
        </div>

        <div class="flex flex-col items-center gap-2">
            <div class="font-semibold">
                Secondary muscle group{{
                    exerciseData.baseData.secondaryMuscleGroups.length === 1
                        ? ""
                        : "s"
                }}:
            </div>

            <div class="flex items-center gap-2">
                @for (secondaryMuscleGroup of
                exerciseData.baseData.secondaryMuscleGroups; track $index) {
                <a
                    class="flex flex-col items-center gap-0.5"
                    [routerLink]="secondaryMuscleGroup.id"
                >
                    <div
                        class="overflow-hidden border-2 border-solid rounded-full min-w-max border-emerald-500"
                    >
                        <img
                            [src]="secondaryMuscleGroup.imagePreviewUrl"
                            class="w-12 h-12 bg-neutral-950"
                            [alt]="secondaryMuscleGroup.name + ' graphic'"
                        />
                    </div>

                    <div class="text-sm font-semibold text-emerald-500">
                        {{ secondaryMuscleGroup.name }}
                    </div>
                </a>
                }
            </div>
        </div>
    </div>

    <app-exercise-charts
        [exerciseId]="exerciseId!"
        [workouts]="exerciseData.workoutsWithExercise"
    ></app-exercise-charts>

    <app-tabs [tabNames]="['How to', 'History', 'Variations', 'Records']">
        <ng-template #tabContent1>
            <app-instruction
                [steps]="exerciseData.detailsData.instructionSteps"
            ></app-instruction>
        </ng-template>
        <ng-template #tabContent2>
            <div class="flex flex-col gap-8">
                <!-- prettier-ignore -->
                @for (workoutWithExercise of exerciseData.workoutsWithExercise; track $index) {
                <div class="flex flex-col gap-1">
                    <a
                        [routerLink]="
                            '/user/profile/history/' + workoutWithExercise.id
                        "
                        class="flex flex-col items-center self-center mb-3 transition-opacity group active:opacity-50"
                    >
                        <div
                            class="flex items-center text-2xl font-semibold text-emerald-500"
                        >
                            {{ workoutWithExercise.name }}

                            <svg
                                class="w-8 h-8 stroke-emerald-500 mt-0.5 group-hover:translate-x-0.5 transition-transform"
                                viewBox="0 0 24 24"
                                fill="none"
                                xmlns="http://www.w3.org/2000/svg"
                            >
                                <path
                                    d="M9 6L15 12L9 18"
                                    stroke-width="2"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                />
                            </svg>
                        </div>
                        <div class="text-sm font-semibold text-neutral-700">
                            {{ workoutWithExercise.dateStart | fullDate }}
                        </div>
                    </a>
                    <div
                        class="grid grid-cols-5 font-semibold opacity-50 justify-items-center"
                    >
                        <div>Set</div>
                        <div>Type</div>
                        <div>Weight</div>
                        <div>Reps</div>
                        <div>Rpe</div>
                    </div>
                    <div class="flex flex-col gap-1 text-lg">
                        <!-- prettier-ignore -->
                        @for (exercise of workoutWithExercise.exercises; track $index) {
                        <!--  -->
                        @if (exercise.exerciseId === exerciseId) {
                        <!--  -->
                        @for (set of exercise.sets; track $index) {
                        <div
                            class="relative grid content-center grid-cols-5 py-2 overflow-hidden font-semibold transition-colors rounded-md justify-items-center gap-y-3 group"
                            [ngClass]="{
                                'bg-neutral-900': $index % 2 === 0,
                                'bg-opacity-50': $index % 2 === 0
                            }"
                        >
                            <div>{{ set.setNumber }}</div>
                            <div>{{ set.setTypeName[0] | titlecase }}</div>
                            <div>{{ set.weight ? set.weight : "-" }}</div>
                            <div>{{ set.reps ? set.reps : "-" }}</div>
                            <div>{{ set.rpe ? set.rpe : "-" }}</div>
                        </div>
                        }
                        <!--  -->
                        }
                        <!--  -->
                        }
                    </div>
                </div>
                }
            </div>
        </ng-template>
        <ng-template #tabContent3>
            <div class="flex flex-col gap-2">
                <!-- @for (exercise of exercises; track $index) {
                    <a
                        [routerLink]="exercise.name"
                        class="flex items-center w-full gap-2 transition-all rounded-md cursor-pointer active:opacity-50 active:scale-95"
                    >
                        <div
                            class="overflow-hidden border-2 border-solid rounded-full min-w-max border-emerald-500"
                        >
                            <img
                                [src]="exercise.iconRoute"
                                class="w-12 h-12"
                                [alt]="exercise.name + ' icon'"
                            />
                        </div>
                        <div class="flex flex-col">
                            <div class="font-semibold">{{ exercise.name }}</div>
                            <div class="text-sm opacity-50">
                                {{ exercise.muscleGroups }}
                            </div>
                        </div>
                    </a>
                    } -->
            </div>
        </ng-template>
        <ng-template #tabContent4>
            <div class="relative">
                <svg
                    class="absolute top-0 z-10 -translate-x-1/2 opacity-25 w-80 h-80 stroke-neutral-900 left-1/2"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <path
                        d="M6.74534 4H17.3132C17.3132 4 16.4326 17.2571 12.0293 17.2571C9.87826 17.2571 8.56786 14.0935 7.79011 10.8571C6.97574 7.46844 6.74534 4 6.74534 4Z"
                        stroke-width="1.5"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                    />
                    <path
                        d="M17.3132 4C17.3132 4 18.2344 3.01733 19 2.99999C20.5 2.96603 20.7773 4 20.7773 4C21.0709 4.60953 21.3057 6.19429 19.8967 7.65715C18.4876 9.12 16.9103 10.4 16.2684 10.8571"
                        stroke-width="1.5"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                    />
                    <path
                        d="M6.74527 4.00001C6.74527 4.00001 5.78547 3.00614 4.99995 3.00001C3.49995 2.9883 3.22264 4.00001 3.22264 4.00001C2.92908 4.60953 2.69424 6.19429 4.1033 7.65715C5.51235 9.12001 7.14823 10.4 7.79004 10.8572"
                        stroke-width="1.5"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                    />
                    <path
                        d="M8.50662 20C8.50662 18.1714 12.0292 17.2571 12.0292 17.2571C12.0292 17.2571 15.5519 18.1714 15.5519 20H8.50662Z"
                        stroke-width="1.5"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                    />
                </svg>
                <div
                    class="relative z-20 flex flex-col items-center gap-4 backdrop-blur-sm"
                >
                    <div class="flex flex-col items-center">
                        <div class="text-xl font-semibold">
                            Heaviest Weight (1rm)
                        </div>
                        <div class="text-2xl font-semibold text-emerald-500">
                            240kg
                        </div>
                    </div>
                    <div class="flex flex-col items-center">
                        <div class="text-xl font-semibold">Most Weight Set</div>
                        <div class="text-2xl font-semibold text-emerald-500">
                            180kg x 6 Reps
                        </div>
                        <div class="text-sm opacity-50 text-emerald-500">
                            Total Weight: 1080kg
                        </div>
                    </div>
                    <div class="flex flex-col items-center">
                        <div class="text-xl font-semibold">Most Reps Set</div>
                        <div class="text-2xl font-semibold text-emerald-500">
                            120kg x 8 Reps
                        </div>
                        <div class="text-sm opacity-50 text-emerald-500">
                            Total Weight: 960kg
                        </div>
                    </div>
                    <div class="flex flex-col items-center">
                        <div class="text-xl font-semibold">
                            Most Weight Workout
                        </div>
                        <div class="text-2xl font-semibold text-emerald-500">
                            4 Sets x 140kg x 5 Reps
                        </div>
                        <div class="text-sm opacity-50 text-emerald-500">
                            Total Weight: 2800kg
                        </div>
                    </div>
                </div>
            </div>
        </ng-template>
        <ng-template #tabContent4>
            <app-records
                [workouts]="exerciseData.workoutsWithExercise"
                [exerciseId]="exerciseId!"
            ></app-records>
        </ng-template>
    </app-tabs>
</div>
} @else {
<div>loading</div>
}
