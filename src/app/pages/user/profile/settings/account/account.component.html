<app-activity-bar title="Account's settings">
    <app-previous-route-button leftSide></app-previous-route-button>
    <div rightSide></div>
</app-activity-bar>

<div class="flex flex-col gap-2 p-4 font-semibold">
    <button
        type="button"
        (click)="openModal('pfp', 'Set new profile picture', 'Save')"
        class="flex items-center w-full gap-2.5 p-2 transition-opacity active:opacity-50 rounded-md hover:bg-neutral-900"
    >
        <svg
            class="w-6 h-6 scale-90 stroke-white"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
        >
            <path
                d="M2 19V9C2 7.89543 2.89543 7 4 7H4.5C5.12951 7 5.72229 6.70361 6.1 6.2L8.32 3.24C8.43331 3.08892 8.61115 3 8.8 3H15.2C15.3889 3 15.5667 3.08892 15.68 3.24L17.9 6.2C18.2777 6.70361 18.8705 7 19.5 7H20C21.1046 7 22 7.89543 22 9V19C22 20.1046 21.1046 21 20 21H4C2.89543 21 2 20.1046 2 19Z"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
            />
            <path
                d="M12 17C14.2091 17 16 15.2091 16 13C16 10.7909 14.2091 9 12 9C9.79086 9 8 10.7909 8 13C8 15.2091 9.79086 17 12 17Z"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
            />
        </svg>
        <div>Change profile picture</div>
    </button>

    <button
        type="button"
        (click)="openModal('username', 'Change username', 'Set new username')"
        class="flex items-center w-full gap-2.5 p-2 transition-opacity active:opacity-50 rounded-md hover:bg-neutral-900"
    >
        <svg
            class="stroke-white w-6 h-6 mt-0.5"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
        >
            <path
                d="M5 20V19C5 15.134 8.13401 12 12 12V12C15.866 12 19 15.134 19 19V20"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
            />
            <path
                d="M12 12C14.2091 12 16 10.2091 16 8C16 5.79086 14.2091 4 12 4C9.79086 4 8 5.79086 8 8C8 10.2091 9.79086 12 12 12Z"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
            />
        </svg>
        <div>Change username</div>
    </button>

    <button
        type="button"
        (click)="openModal('password', 'Change password', 'Set new password')"
        class="flex items-center w-full gap-2.5 p-2 transition-opacity active:opacity-50 rounded-md hover:bg-neutral-900"
    >
        <svg
            class="w-6 h-6 stroke-white"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
        >
            <path
                d="M16 12H17.4C17.7314 12 18 12.2686 18 12.6V19.4C18 19.7314 17.7314 20 17.4 20H6.6C6.26863 20 6 19.7314 6 19.4V12.6C6 12.2686 6.26863 12 6.6 12H8M16 12V8C16 6.66667 15.2 4 12 4C8.8 4 8 6.66667 8 8V12M16 12H8"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
            />
        </svg>
        <div>Change password</div>
    </button>

    <button
        type="button"
        (click)="openModal('deletion', 'Delete your account', 'Proceed')"
        class="py-1.5 mt-4 font-semibold rounded-md w-full bg-red-500 transition-all active:opacity-50 hover:shadow-[0_0_20px_2px_#ef4444]"
    >
        Delete Account
    </button>
</div>

@if (modalVisibility) {
<!-- eslint-disable-next-line -->
<div
    @openClose2
    (click)="modalVisibility = false"
    class="fixed top-0 left-0 z-40 w-screen h-screen bg-black bg-opacity-80"
></div>

<div
    @openClose
    class="fixed left-0 z-50 flex flex-col w-full h-full gap-2 p-4 overflow-y-scroll transition-all duration-300 bg-neutral-950 rounded-t-md pb-96"
    [ngClass]="{
        'top-1/2': modalVisibility,
        'top-full': !modalVisibility
    }"
>
    <div class="self-center text-lg font-semibold">{{ activeTitle }}:</div>

    <!--  -->

    @if (activeModalType === 'pfp') {
    <div class="relative flex flex-col self-center mt-4">
        @if (selectedThumbnail) {
        <img [src]="selectedThumbnail" class="w-32 h-32 rounded-full" alt="" />

        <button
            type="button"
            (click)="removePfp()"
            class="absolute right-0 transition-opacity bg-red-500 rounded-full bottom-2 group active:opacity-50"
        >
            <svg
                class="transition-transform w-8 h-8 p-0.5 stroke-white group-hover:rotate-90"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
            >
                <path
                    d="M6.75827 17.2426L12.0009 12M17.2435 6.75736L12.0009 12M12.0009 12L6.75827 6.75736M12.0009 12L17.2435 17.2426"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
            </svg>
        </button>
        } @else {
        <label
            for="thumbnailInput"
            class="relative self-center w-32 h-32 transition-opacity bg-opacity-50 rounded-full cursor-pointer bg-neutral-900 active:opacity-50"
        >
            <svg
                class="absolute -translate-x-1/2 -translate-y-1/2 w-14 h-14 stroke-neutral-700 top-1/2 left-1/2"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
            >
                <path
                    d="M2 19V9C2 7.89543 2.89543 7 4 7H4.5C5.12951 7 5.72229 6.70361 6.1 6.2L8.32 3.24C8.43331 3.08892 8.61115 3 8.8 3H15.2C15.3889 3 15.5667 3.08892 15.68 3.24L17.9 6.2C18.2777 6.70361 18.8705 7 19.5 7H20C21.1046 7 22 7.89543 22 9V19C22 20.1046 21.1046 21 20 21H4C2.89543 21 2 20.1046 2 19Z"
                    stroke-width="1.5"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
                <path
                    d="M12 17C14.2091 17 16 15.2091 16 13C16 10.7909 14.2091 9 12 9C9.79086 9 8 10.7909 8 13C8 15.2091 9.79086 17 12 17Z"
                    stroke-width="1.5"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
            </svg>

            <svg
                class="absolute right-0 w-8 h-8 transition-transform rounded-full bottom-2 stroke-white bg-emerald-500 hover:rotate-90"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
            >
                <path
                    d="M6 12H12M18 12H12M12 12V6M12 12V18"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
            </svg>

            <input
                type="file"
                #thumbnail
                (change)="onPfpSelect()"
                id="thumbnailInput"
                accept=".jpg, .jpeg, .png"
                hidden
            />
        </label>
        }
    </div>
    }

    <!--  -->

    @if (activeModalType === 'username') { }

    <!--  -->

    @if (activeModalType === 'password') { }

    <!--  -->

    @if (activeModalType === 'deletion') { }

    <!--  -->
</div>
}

<!-- -->

@if (modalVisibility) {
<div
    @openClose3
    class="fixed left-0 z-50 w-full p-4 shadow-md rounded-t-md bg-neutral-950"
    [ngClass]="{
        'bottom-0': modalVisibility,
        '-bottom-full': !modalVisibility,
    }"
>
    @if (activeModalType === 'pfp') {
    <button
        type="button"
        (click)="updatePfp()"
        class="py-1.5 mt-2 font-semibold rounded-md w-full bg-emerald-500 transition-all active:opacity-50 hover:shadow-[0_0_20px_2px_#10b981] disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none"
        [disabled]="!selectedThumbnail"
    >
        {{ activeActionBtnName }}
    </button>
    }

    <button
        type="button"
        (click)="modalVisibility = false"
        class="py-1.5 mt-2 font-semibold rounded-md w-full bg-neutral-900 transition-all active:opacity-50 hover:shadow-[0_0_20px_2px_#171717]"
    >
        Cancel & Close
    </button>
</div>
}
